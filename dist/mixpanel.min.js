!function(t){window.WisemblyMixpanel={version:"0.1.4",options:{identifier:"",script:"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",scriptTimeout:5e3,isEnabled:!0,identity:null,onBoot:null,onStore:null,onFlush:null,onTrack:null,onTrackError:null,onScript:null,onScriptError:null},setOptions:function(i){i=i||{},this.options=t.extend(this.options,i)},init:function(){var t=this;window.mixpanel=window.mixpanel||[],window.mixpanel.__SV=1.2,this.boot()||this._loadScript().done(function(){t.boot()})},_get:function(t){return"function"==typeof this.options[t]?this.options[t].call(this):this.options[t]},_notify:function(t){"function"==typeof this.options[t]&&this.options[t].apply(this,[].slice.call(arguments,1))},_loadScript:function(){var i=this;return t.ajax({url:this._get("script"),dataType:"script",timeout:this._get("scriptTimeout")}).done(function(){i._notify("onScript")}).fail(function(){i._notify("onScriptError")})},boot:function(){return this.isEnabled()?(window.mixpanel.init(this._get("identifier")),this.track("identify",this._get("identity"),{},!0),this._notify("onBoot"),!0):!1},isReady:function(){return window.mixpanel&&"function"==typeof window.mixpanel.init&&this.options},isEnabled:function(){return this.isReady()?this._get("isEnabled"):!1},track:function(t,i,n,e){return t?(this.store(t,i,n,e),this.isReady()&&this.flush(),!0):!1},store:function(i,n,e,o){this._storedEvents=this._storedEvents||[],this._storedId=this._storedId||0;var s={id:++this._storedId,dfd:t.Deferred(),type:i,data:n,metadata:e};return o!==!0?this._storedEvents.push(s):this._storedEvents.unshift(s),this._notify("onStore",s),s},flush:function(){for(var t=this;this._storedEvents&&this._storedEvents.length;)!function(i){t._notify("onFlush",i),t.mixpanelTrack(i).done(function(){t._notify("onTrack",i)}).fail(function(){t._notify("onTrackError",i)})}(this._storedEvents.shift())},mixpanelTrack:function(t){if(!this.isEnabled())return t.dfd.reject().promise();var i=function(i){1===i?t.dfd.resolve():t.dfd.reject()};switch(t.type){case"identify":window.mixpanel.identify(t.data),window.mixpanel.register({user_id:t.data}),t.dfd.resolve();break;case"track":window.mixpanel.track(t.data,t.metadata,i);break;case"people.set":window.mixpanel.people.set(t.data,i);break;case"people.set_once":window.mixpanel.people.set_once(t.data,i);break;case"people.increment":window.mixpanel.people.increment(t.data,i);break;case"people.append":window.mixpanel.people.append(t.data,i);break;case"people.track_charge":window.mixpanel.people.track_charge(t.data,i);break;default:t.dfd.reject()}return t.dfd.promise()}}}(jQuery);