!function(t){if("undefined"!=typeof define&&define.amd)define(["jquery"],t);else if("undefined"!=typeof require)module.exports=t(require("jquery"));else{if("undefined"==typeof window)throw new Error("Unsupported environment");window.WisemblyRealTime=t(window.$)}}(function(t){var i=function(t){this.init(t)};return i.version="0.2.0",i.prototype={defaultOptions:{identifier:"",script:"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",scriptTimeout:5e3,isEnabled:!0,identity:null,onBoot:null,onStore:null,onFlush:null,onTrack:null,onTrackError:null,onScript:null,onScriptError:null},init:function(i){var e=this;i=i||{},this.options=t.extend({},this.defaultOptions,i),window.mixpanel=window.mixpanel||[],window.mixpanel.__SV=1.2,this.boot()||this._loadScript().done(function(){e.boot()})},_get:function(t){return"function"==typeof this.options[t]?this.options[t].call(this):this.options[t]},_notify:function(t){"function"==typeof this.options[t]&&this.options[t].apply(this,[].slice.call(arguments,1))},_loadScript:function(){var i=this;return t.ajax({url:this._get("script"),dataType:"script",timeout:this._get("scriptTimeout")}).done(function(){i._notify("onScript")}).fail(function(){i._notify("onScriptError")})},boot:function(){return!(!this.isLoaded()||!this.isEnabled())&&(window.mixpanel.init(this._get("identifier")),this.initialized=!0,this.track("identify",this._get("identity"),{},!0),this._notify("onBoot"),!0)},isLoaded:function(){return window.mixpanel&&"function"==typeof window.mixpanel.init},isReady:function(){return this.initialized},isEnabled:function(){return this._get("isEnabled")},track:function(t,i,e,n){return!!t&&(this.store(t,i,e,n),this.isReady()&&this.isEnabled()&&this.flush(),!0)},store:function(i,e,n,o){this._storedEvents=this._storedEvents||[],this._storedId=this._storedId||0;var r={id:++this._storedId,dfd:t.Deferred(),type:i,data:e,metadata:n};return o!==!0?this._storedEvents.push(r):this._storedEvents.unshift(r),this._notify("onStore",r),r},flush:function(){for(var t=this;this._storedEvents&&this._storedEvents.length;)!function(i){t._notify("onFlush",i),t.mixpanelTrack(i).done(function(){t._notify("onTrack",i)}).fail(function(){t._notify("onTrackError",i)})}(this._storedEvents.shift())},mixpanelTrack:function(t){if(!this.isReady()||!this.isEnabled())return t.dfd.reject().promise();var i=function(i){1===i?t.dfd.resolve():t.dfd.reject()};switch(t.type){case"identify":window.mixpanel.identify(t.data),window.mixpanel.register({user_id:t.data}),t.dfd.resolve();break;case"track":window.mixpanel.track(t.data,t.metadata,i);break;case"people.set":window.mixpanel.people.set(t.data,i);break;case"people.set_once":window.mixpanel.people.set_once(t.data,i);break;case"people.increment":var e=t.metadata?t.metadata.increment:void 0;window.mixpanel.people.increment(t.data,e,i);break;case"people.append":window.mixpanel.people.append(t.data,i);break;case"people.track_charge":window.mixpanel.people.track_charge(t.data,i);break;default:t.dfd.reject()}return t.dfd.promise()}},i});