!function(e){if("undefined"!=typeof define&&define.amd)define(["jquery","mixpanel-browser"],e);else if("undefined"!=typeof require)module.exports=e(require("jquery"),require("mixpanel-browser"));else{if("undefined"==typeof window)throw new Error("Unsupported environment");window.WisemblyRealTime=e(window.$,window.mixpanel)}}(function(e,t){var i=function(e){this.init(e)};return i.version="0.2.0",i.prototype={defaultOptions:{identifier:"",isEnabled:!0,identity:null,onBoot:null,onStore:null,onFlush:null,onTrack:null,onTrackError:null},init:function(i){this.options=e.extend({},this.defaultOptions,i||{}),t.__SV=1.2,this.boot()},_get:function(e){return"function"==typeof this.options[e]?this.options[e].call(this):this.options[e]},_notify:function(e){"function"==typeof this.options[e]&&this.options[e].apply(this,[].slice.call(arguments,1))},boot:function(){return!!this.isEnabled()&&(t.init(this._get("identifier")),this.initialized=!0,this.track("identify",this._get("identity"),{},!0),this._notify("onBoot"),!0)},isReady:function(){return this.initialized},isEnabled:function(){return this._get("isEnabled")},track:function(e,t,i,n){return!!e&&(this.store(e,t,i,n),this.isReady()&&this.isEnabled()&&this.flush(),!0)},store:function(t,i,n,o){this._storedEvents=this._storedEvents||[],this._storedId=this._storedId||0;var s={id:++this._storedId,dfd:e.Deferred(),type:t,data:i,metadata:n};return o!==!0?this._storedEvents.push(s):this._storedEvents.unshift(s),this._notify("onStore",s),s},flush:function(){for(var e=this;this._storedEvents&&this._storedEvents.length;)!function(t){e._notify("onFlush",t),e.mixpanelTrack(t).done(function(){e._notify("onTrack",t)}).fail(function(){e._notify("onTrackError",t)})}(this._storedEvents.shift())},mixpanelTrack:function(e){if(!this.isReady()||!this.isEnabled())return e.dfd.reject().promise();var i=function(t){1===t?e.dfd.resolve():e.dfd.reject()};switch(e.type){case"identify":t.identify(e.data),t.register({user_id:e.data}),e.dfd.resolve();break;case"track":t.track(e.data,e.metadata,i);break;case"people.set":t.people.set(e.data,i);break;case"people.set_once":t.people.set_once(e.data,i);break;case"people.increment":var n=e.metadata?e.metadata.increment:void 0;t.people.increment(e.data,n,i);break;case"people.append":t.people.append(e.data,i);break;case"people.track_charge":t.people.track_charge(e.data,i);break;default:e.dfd.reject()}return e.dfd.promise()}},i});